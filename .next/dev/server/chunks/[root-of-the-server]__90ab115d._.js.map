{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ROSE%20MEHRA/Downloads/mtathagat_2-main/app/api/contact/route.ts"],"sourcesContent":["// app/api/contact/route.ts\nimport nodemailer from \"nodemailer\";\nimport { NextResponse } from \"next/server\";\n\ntype Body = {\n  name?: string;\n  phone?: string;\n  email?: string;\n  message?: string;\n};\n\nconst sanitize = (s?: string) => (s || \"\").trim();\n\nexport async function POST(request: Request) {\n  try {\n    const body: Body = await request.json();\n\n    const name = sanitize(body.name);\n    const phone = sanitize(body.phone);\n    const email = sanitize(body.email);\n    const message = sanitize(body.message);\n\n    // basic validation\n    if (!phone) {\n      return NextResponse.json({ error: \"Phone number is required.\" }, { status: 400 });\n    }\n\n    // Build email content (HTML + plain)\n    const subject = `New contact form enquiry from ${name || \"Unknown\"}`;\n    const plain = `\nNew contact form submission\n\nName: ${name || \"—\"}\nPhone: ${phone}\nEmail: ${email || \"—\"}\nMessage:\n${message || \"—\"}\n    `.trim();\n\n    const html = `\n      <h2>New contact form submission</h2>\n      <p><strong>Name:</strong> ${name || \"—\"}</p>\n      <p><strong>Phone:</strong> ${phone}</p>\n      <p><strong>Email:</strong> ${email || \"—\"}</p>\n      <p><strong>Message:</strong></p>\n      <pre style=\"white-space:pre-wrap;\">${message || \"—\"}</pre>\n      <hr/>\n      <p>Sent from: your website</p>\n    `;\n\n    // Create transporter using env vars\n    // Required env vars: SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS, FROM_EMAIL (optional), TO_EMAIL (optional)\n    const host = process.env.SMTP_HOST;\n    const port = parseInt(process.env.SMTP_PORT || \"587\", 10);\n    const user = process.env.SMTP_USER;\n    const pass = process.env.SMTP_PASS;\n\n    if (!host || !user || !pass) {\n      console.error(\"SMTP credentials missing. Make sure SMTP_HOST, SMTP_USER, SMTP_PASS are set.\");\n      return NextResponse.json({ error: \"Mailer not configured.\" }, { status: 500 });\n    }\n\n    const fromEmail = process.env.FROM_EMAIL || \"info@mtdevelopers.com\";\n    const toEmail = process.env.TO_EMAIL || \"info@mtdevelopers.com\";\n\n    const transporter = nodemailer.createTransport({\n      host,\n      port,\n      secure: port === 465, // true for 465, false for other ports\n      auth: {\n        user,\n        pass,\n      },\n    });\n\n    // optional: verify transporter once (not required every request)\n    // await transporter.verify();\n\n    const mailResult = await transporter.sendMail({\n      from: `\"Website Contact\" <${fromEmail}>`,\n      to: toEmail,\n      subject,\n      text: plain,\n      html,\n      replyTo: email || undefined,\n    });\n\n    console.log(\"Contact form email sent:\", mailResult);\n\n    return NextResponse.json({ ok: true, message: \"Email sent.\" });\n  } catch (err: any) {\n    console.error(\"Error in /api/contact:\", err);\n    return NextResponse.json({ error: \"Internal server error.\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;AAC3B;AACA;;;AASA,MAAM,WAAW,CAAC,IAAe,CAAC,KAAK,EAAE,EAAE,IAAI;AAExC,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAa,MAAM,QAAQ,IAAI;QAErC,MAAM,OAAO,SAAS,KAAK,IAAI;QAC/B,MAAM,QAAQ,SAAS,KAAK,KAAK;QACjC,MAAM,QAAQ,SAAS,KAAK,KAAK;QACjC,MAAM,UAAU,SAAS,KAAK,OAAO;QAErC,mBAAmB;QACnB,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,qCAAqC;QACrC,MAAM,UAAU,CAAC,8BAA8B,EAAE,QAAQ,WAAW;QACpE,MAAM,QAAQ,CAAC;;;MAGb,EAAE,QAAQ,IAAI;OACb,EAAE,MAAM;OACR,EAAE,SAAS,IAAI;;AAEtB,EAAE,WAAW,IAAI;IACb,CAAC,CAAC,IAAI;QAEN,MAAM,OAAO,CAAC;;gCAEc,EAAE,QAAQ,IAAI;iCACb,EAAE,MAAM;iCACR,EAAE,SAAS,IAAI;;yCAEP,EAAE,WAAW,IAAI;;;IAGtD,CAAC;QAED,oCAAoC;QACpC,4GAA4G;QAC5G,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS;QAClC,MAAM,OAAO,SAAS,QAAQ,GAAG,CAAC,SAAS,IAAI,OAAO;QACtD,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS;QAClC,MAAM,OAAO,QAAQ,GAAG,CAAC,SAAS;QAElC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM;YAC3B,QAAQ,KAAK,CAAC;YACd,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAC9E;QAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,UAAU,IAAI;QAC5C,MAAM,UAAU,QAAQ,GAAG,CAAC,QAAQ,IAAI;QAExC,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;YAC7C;YACA;YACA,QAAQ,SAAS;YACjB,MAAM;gBACJ;gBACA;YACF;QACF;QAEA,iEAAiE;QACjE,8BAA8B;QAE9B,MAAM,aAAa,MAAM,YAAY,QAAQ,CAAC;YAC5C,MAAM,CAAC,mBAAmB,EAAE,UAAU,CAAC,CAAC;YACxC,IAAI;YACJ;YACA,MAAM;YACN;YACA,SAAS,SAAS;QACpB;QAEA,QAAQ,GAAG,CAAC,4BAA4B;QAExC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,SAAS;QAAc;IAC9D,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAC9E;AACF"}}]
}